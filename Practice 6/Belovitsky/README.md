# Задание 6.## Беловицкий Владислав БПИ198## Задача 1.```countries ( name, country_id, area_sqkm, population )events ( event_id, name, eventtype, olympic_id, is_team_event, num_players_in_team, result_noted_in )olympics ( olympic_id, country_id, city, year, startdate, enddate )players ( name, player_id, country_id, birthdate )results ( event_id, player_id, medal, result )```### 1. Для Олимпийских игр 2004 года сгенерируйте список (год рождения, количество игроков, количество золотых медалей), содержащий годы, в которые родились игроки, количество игроков, родившихся в каждый из этих лет, которые выиграли по крайней мере одну золотую медаль, и количество золотых медалей, завоеванных игроками, родившимися в этом году.``` sqlSELECT date_part('year', p.birthdate) AS birth_year    ,count(DISTINCT p.player_id) AS player_count    ,count(r.medal) AS medal_countFROM olympics oJOIN events e ON e.olympic_id = o.olympic_id AND o.year = 2004JOIN results r ON r.event_id = e.event_idJOIN players p ON p.player_id = r.player_idWHERE r.medal = 'GOLD'GROUP BY date_part('year', p.birthdate);```### 2. Перечислите все индивидуальные (не групповые) соревнования, в которых была ничья в счете, и два или более игрока выиграли золотую медаль.``` sqlSELECT e.event_id	, e.nameFROM results r1JOIN results r2 ON r2.event_id = r1.event_id AND r2.player_id = r1.player_id AND r2.result = r1.resultJOIN events e ON e.event_id = r1.event_id AND e.is_team_event = 0GROUP BY e.event_id, e.nameHAVING count(*) FILTER (WHERE r1.medal = 'GOLD') >= 2;```### 3. Найдите всех игроков, которые выиграли хотя бы одну медаль (GOLD, SILVER и BRONZE) на одной Олимпиаде. (player-name, olympic-id).``` sqlSELECT p.name	, o.olympic_idFROM players pJOIN results r ON r.player_id = p.player_id AND r.medal IN ('GOLD', 'SILVER', 'BRONZE')JOIN events e ON e.event_id = r.event_idJOIN olympics o ON o.olympic_id = e.olympic_idGROUP BY p.player_id, p.name, o.olympic_id;```### 4. В какой стране был наибольший процент игроков (из перечисленных в наборе данных), чьи имена начинались с гласной?``` sqlSELECT c.name, stats.players_percentageFROM countries cJOIN (        SELECT p.country_id            ,count(*) FILTER ( WHERE p.name ~* '^[aeiouy].*$')::float / count(*) AS players_percentage        FROM players p        GROUP BY p.country_id    ) AS stats ON stats.country_id = c.country_idORDER BY stats.players_percentage DESC, c.nameLIMIT 1;```### 5. Для Олимпийских игр 2000 года найдите 5 стран с минимальным соотношением количества групповых медалей к численности населения.``` sqlSELECT c.nameFROM countries cJOIN players p ON p.country_id = c.country_idJOIN results r ON r.player_id = p.player_idJOIN events e ON e.event_id = r.event_id AND e.is_team_event = 1 AND e.olympic_id = (SELECT oe.olympic_id FROM olympics oe WHERE oe.year = 2000)GROUP BY c.name, c.populationORDER BY count(r.event_id)::float / c.populationLIMIT 5;```